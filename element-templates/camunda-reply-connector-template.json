{
  "$schema": "https://unpkg.com/@camunda/zeebe-element-templates-json-schema/resources/schema.json",
  "name": "Camunda Chat • Reply",
  "id": "io.camunda.chat.rest.reply.camunda-chat-admin-986421179728.europe-west1.run.app.v1",
  "description": "Sends a reply message to a conversation in the Camunda chat.",
  "version": 1,
  "category": {
    "id": "connectors",
    "name": "Connectors"
  },
  "appliesTo": [
    "bpmn:ServiceTask"
  ],
  "elementType": {
    "value": "bpmn:ServiceTask"
  },
  "groups": [
    {
      "id": "endpoint",
      "label": "Endpoint",
      "openByDefault": true
    },
    {
      "id": "ids",
      "label": "Identifiers"
    },
    {
      "id": "auth",
      "label": "Authentication"
    },
    {
      "id": "payload",
      "label": "Payload"
    },
    {
      "id": "advanced",
      "label": "Advanced"
    }
  ],
  "properties": [
    {
      "type": "Hidden",
      "binding": {
        "type": "zeebe:taskDefinition",
        "property": "type"
      },
      "value": "io.camunda:http-json:1"
    },
    {
      "type": "Hidden",
      "binding": {
        "type": "zeebe:taskDefinition",
        "property": "retries"
      },
      "value": "3"
    },
    {
      "id": "apiBaseUrl",
      "label": "API base URL",
      "group": "endpoint",
      "type": "String",
      "value": "https://camunda-chat-admin-986421179728.europe-west1.run.app/api/",
      "binding": {
        "type": "zeebe:input",
        "name": "apiBaseUrl"
      },
      "constraints": {
        "notEmpty": true,
        "pattern": {
          "value": "^https?://.*",
          "message": "Must start with http(s)://"
        }
      }
    },
    {
      "id": "channelUUID",
      "label": "Channel UUID",
      "group": "ids",
      "type": "String",
      "feel": "optional",
      "value": "=channelUUID",
      "binding": {
        "type": "zeebe:input",
        "name": "channelUUID"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "id": "conversationUUID",
      "label": "Conversation UUID",
      "group": "ids",
      "type": "String",
      "feel": "required",
      "value": "=conversationUUID",
      "binding": {
        "type": "zeebe:input",
        "name": "conversationUUID"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "id": "authToken",
      "label": "Bearer token",
      "description": "Tip: prefer secrets, e.g. {{secrets.CHAT_BACKEND_TOKEN}}",
      "group": "auth",
      "type": "String",
      "feel": "optional",
      "value": "{{secrets.CHAT_BACKEND_SERVICE_TOKEN}}",
      "binding": {
        "type": "zeebe:input",
        "name": "authToken"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "id": "messageType",
      "label": "Message type",
      "group": "payload",
      "type": "Dropdown",
      "value": "text",
      "choices": [
        {
          "name": "Reply",
          "value": "text"
        },
        {
          "name": "Markdown",
          "value": "markdown"
        },
        {
          "name": "Thinking update",
          "value": "thinking"
        }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "messageType"
      }
    },
    {
      "id": "content",
      "label": "Content",
      "group": "payload",
      "type": "Text",
      "placeholder": "Write the text to send…",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "content"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "id": "authentication",
      "type": "Hidden",
      "group": "auth",
      "value": "={\"type\": \"bearer\", \"token\": authToken}",
      "binding": {
        "type": "zeebe:input",
        "name": "authentication"
      }
    },
    {
      "id": "method",
      "type": "Hidden",
      "value": "PUT",
      "binding": {
        "type": "zeebe:input",
        "name": "method"
      }
    },
    {
      "id": "url",
      "type": "Hidden",
      "value": "=apiBaseUrl + \"channels/\" + channelUUID + \"/conversations/\" + conversationUUID + \"/messages/\" + uuid()",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      }
    },
    {
      "id": "body",
      "type": "Hidden",
      "value": "={\"senderUsername\":\"Camunda\",\"parts\":[{\"type\": messageType, \"content\": content, \"position\": 0}]}",
      "binding": {
        "type": "zeebe:input",
        "name": "body"
      }
    },
    {
      "id": "storeResponse",
      "type": "Hidden",
      "value": "=false",
      "binding": {
        "type": "zeebe:input",
        "name": "storeResponse"
      }
    },
    {
      "id": "ignoreNullValues",
      "type": "Hidden",
      "value": "=false",
      "binding": {
        "type": "zeebe:input",
        "name": "ignoreNullValues"
      }
    },
    {
      "id": "connectionTimeoutInSeconds",
      "type": "Hidden",
      "value": "=20",
      "binding": {
        "type": "zeebe:input",
        "name": "connectionTimeoutInSeconds"
      }
    },
    {
      "id": "readTimeoutInSeconds",
      "type": "Hidden",
      "value": "=20",
      "binding": {
        "type": "zeebe:input",
        "name": "readTimeoutInSeconds"
      }
    },
    {
      "id": "retryBackoff",
      "type": "Hidden",
      "binding": {
        "type": "zeebe:taskHeader",
        "key": "retryBackoff"
      },
      "value": "PT0S"
    }
  ],
  "icon": {
    "contents": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzIwMDFfNTApIj4KPHBhdGggZD0iTTE3Ljk4ODYgMzEuODU3MUwxNiAzMC43MTQzTDIwLjU3MTQgMjIuNzE0M0gyNy40Mjg2QzI4LjAzNDggMjIuNzE0MyAyOC42MTYyIDIyLjQ3MzUgMjkuMDQ0OCAyMi4wNDQ4QzI5LjQ3MzUgMjEuNjE2MiAyOS43MTQzIDIxLjAzNDggMjkuNzE0MyAyMC40Mjg2VjYuNzE0MjhDMjkuNzE0MyA2LjEwODA3IDI5LjQ3MzUgNS41MjY2OSAyOS4wNDQ4IDUuMDk4MDRDMjguNjE2MiA0LjY2OTM4IDI4LjAzNDggNC40Mjg1NyAyNy40Mjg2IDQuNDI4NTdINC41NzE0M0MzLjk2NTIyIDQuNDI4NTcgMy4zODM4NCA0LjY2OTM4IDIuOTU1MTggNS4wOTgwNEMyLjUyNjUzIDUuNTI2NjkgMi4yODU3MSA2LjEwODA3IDIuMjg1NzEgNi43MTQyOFYyMC40Mjg2QzIuMjg1NzEgMjEuMDM0OCAyLjUyNjUzIDIxLjYxNjIgMi45NTUxOCAyMi4wNDQ4QzMuMzgzODQgMjIuNDczNSAzLjk2NTIyIDIyLjcxNDMgNC41NzE0MyAyMi43MTQzSDE0Ljg1NzFWMjVINC41NzE0M0MzLjM1OTAxIDI1IDIuMTk2MjUgMjQuNTE4NCAxLjMzODk0IDIzLjY2MTFDMC40ODE2MzEgMjIuODAzNyAwIDIxLjY0MSAwIDIwLjQyODZWNi43MTQyOEMwIDUuNTAxODYgMC40ODE2MzEgNC4zMzkxIDEuMzM4OTQgMy40ODE3OUMyLjE5NjI1IDIuNjI0NDggMy4zNTkwMSAyLjE0Mjg1IDQuNTcxNDMgMi4xNDI4NUgyNy40Mjg2QzI4LjY0MSAyLjE0Mjg1IDI5LjgwMzggMi42MjQ0OCAzMC42NjExIDMuNDgxNzlDMzEuNTE4NCA0LjMzOTEgMzIgNS41MDE4NiAzMiA2LjcxNDI4VjIwLjQyODZDMzIgMjEuNjQxIDMxLjUxODQgMjIuODAzNyAzMC42NjExIDIzLjY2MTFDMjkuODAzOCAyNC41MTg0IDI4LjY0MSAyNSAyNy40Mjg2IDI1SDIxLjg5NzFMMTcuOTg4NiAzMS44NTcxWiIgZmlsbD0iIzBGNjJGRSIvPgo8cGF0aCBkPSJNMjUuMTQyOSA5SDYuODU3MThWMTEuMjg1N0gyNS4xNDI5VjlaIiBmaWxsPSIjMEY2MkZFIi8+CjxwYXRoIGQ9Ik0xOC4yODU3IDE1Ljg1NzFINi44NTcxOFYxOC4xNDI5SDE4LjI4NTdWMTUuODU3MVoiIGZpbGw9IiMwRjYyRkUiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8yMDAxXzUwIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo="
  }
}